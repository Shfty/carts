pico-8 cartridge // http://www.pico-8.com
version 16
__lua__
-- perfhud

function draw_perfhud()
	clip()

	local comp_cpu = comp_cpu or 0
 rect(1,1,64,23,6)
 rectfill(2,2,63,22,0)
 
 color(7)
 
 local cpu = stat(1)*100
 local comp_cpu = cpu - 1.6998
 
 local fps = stat(7)
 
 print("cpu  "..cpu.."%",3,3)
 print("    ("..comp_cpu.."%)",3,10)
 print("fps "..fps,3,17)
end
-->8
-- main

scrollx = 0
scrolly = 0

function _update60()
--[[
	scrolly -= 1
	if scrolly < -128 then
		scrolly = 128
	end
]]
end

function _draw()
	cls()
	lsmap(
		0,
		0,
		4,
		32,
		scrollx,
		scrolly
	)
	
	draw_perfhud()
end

function x_scale_scroll(y)
	return -16
end

function x_screen_scroll(y)
	return 64
end

function x_scale(y)
 local ly = y/128
 ly -= 0.5
 ly = sin(ly*0.5)
 ly *= ly
 ly += 0.2
 ly *= 5
	return ly
end

function y_scale(y)
	return 2
end

function lsspr(s,x,y)
	if(s==0) then return end
	
	local sx = (s*8)%128
	local sy = flr(s/16)*8
	
	local i=0
	for ly=y,y+8 do
		if ly >= 0 and ly <= 127 then
 		local xsc = x_scale(ly)
 	
 		if xsc > 0 then
  		local lx = x
  		lx += x_scale_scroll(ly)
  		lx *= xsc
  		lx += x_screen_scroll(ly)
  	
  		sspr(
  			sx,
  			sy+i,
  			8,
  			1,
  			lx,
  			y+i,
  		 8*xsc,
  			1
  		)
 		end
		end
		
		i+=1
	end
end

function lsmap(
	mx,my,
	mw,mh,
	dx,dy
)
	if mw == 0 or mh == 0 then
		return
	end
	
	for x=mx,mx+mw-1 do
		for y=my,my+mh-1 do
			lsspr(
				mget(x,y),
				x*8+dx,
				y*8+dy
			)
		end
	end
end
__gfx__
00000000444444440123456789abcdef000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000499229940123456789abcdef077777700700007000077000077777700777777007777770000000000000000000000000000000000000000000000000
00700700492992940123456789abcdef070000000700007000077000000770000770007007777770000000000000000000000000000000000000000000000000
00077000429679240123456789abcdef077777700777777000077000000770000777777007000070000000000000000000000000000000000000000000000000
00077000429769240123456789abcdef077777700777777000077000000770000770000007000070000000000000000000000000000000000000000000000000
00700700492992940123456789abcdef000000700700007000077000000770000770000007777770000000000000000000000000000000000000000000000000
00000000499229940123456789abcdef077777700700007000077000000770000770000007777770000000000000000000000000000000000000000000000000
00000000444444440123456789abcdef000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbbbbb000000009999999900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbbbbb000000009999999900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbbbbb000000009999999900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbbbbb000000009999999900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbbbbb000000009999999900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbbbbb000000009999999900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbbbbb000000009999999900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
bbbbbbbb000000009999999900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
eeeeeeee00000000cccccccc00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
eeeeeeee00000000cccccccc00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
eeeeeeee00000000cccccccc00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
eeeeeeee00000000cccccccc00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
eeeeeeee00000000cccccccc00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
eeeeeeee00000000cccccccc00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
eeeeeeee00000000cccccccc00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
eeeeeeee00000000cccccccc00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0104070100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0105040100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0106090100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0107080100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0108070100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0109060100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0104050100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0107040100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0203020300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0203020300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0203020300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0203020300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0203020300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0203020300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0203020300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0203020300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
